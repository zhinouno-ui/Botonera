<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BET300VIP - Botonera</title>

  <style>
    html, body { height: 100%; margin: 0; font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif; }
    .bg { position: fixed; inset: 0; z-index: -2; background: #111217; pointer-events: none; }
    .bg img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; object-position: center; }
    .bg .overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.16); }

    :root {
      --width: 1310px;
      --height: 201px;
      --bet300-purple: #8e44ad;
      --bet300-green: #25d366;
      --text-light: #f6f7f8;
    }

    #revinculacion-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 18px 20px;
      min-height: 100vh;
      color: var(--text-light);
    }

    .relinking-block {
      width: var(--width);
      max-width: 100%;
      min-height: var(--height);
      display: flex;
      gap: 18px;
      align-items: flex-start;
    }

    .user-row { flex: 0 0 240px; max-width: 240px; display: none; } /* oculto: ahora tenemos mini-input dentro del panel */

    .message-preview-card {
      position: relative;
      padding: 18px 20px;
      border-radius: 10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.20));
      border: 1px solid rgba(255,255,255,0.02);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02), 0 6px 18px rgba(0,0,0,0.45);
      min-height: 140px;
      flex: 1;
      min-width: 0;
    }

    .msg-flip {
      position: absolute; top: 10px; right: 10px;
      width: 38px; height: 38px; border-radius: 8px;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.26));
      border: 1px solid rgba(255,255,255,0.06);
      display:flex; align-items:center; justify-content:center; cursor:pointer;
      box-shadow: 0 6px 14px rgba(0,0,0,0.45);
    }

    .message-text { font-size: 1.05rem; line-height: 1.5; letter-spacing: 0.2px; word-break: break-word; }

    .action-panel {
      display: flex; flex-direction: column; align-items: center; gap: 10px;
      padding: 14px; border-radius: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.22));
      box-shadow: 0 8px 26px rgba(2,6,12,0.6); backdrop-filter: blur(6px);
      width: 200px; flex: 0 0 auto;
    }

    .action-buttons { display:flex; flex-direction:column; gap:12px; width:100%; }
    .glass-button {
      display:flex; align-items:center; justify-content:center; gap:10px;
      padding:10px 12px; height:44px; border-radius:12px; font-weight:700;
      cursor:pointer; border:1px solid rgba(255,255,255,0.06); background: rgba(255,255,255,0.03);
      color: var(--text-light);
    }
    .copy-button { background: linear-gradient(180deg, var(--bet300-purple), #77339e); color:#fff; }
    .whatsapp-button { background: linear-gradient(180deg, var(--bet300-green), #19b856); color:#fff; }

    /* mini-input: minimal, redondeado, difuminado; se expande al focus */
    .mini-input {
      width: 42px; height: 42px; border-radius: 999px;
      padding: 0 12px; display:inline-flex; align-items:center;
      background: rgba(255,255,255,0.03); color: var(--text-light);
      border:1px solid rgba(255,255,255,0.06); backdrop-filter: blur(6px);
      box-shadow: 0 6px 14px rgba(0,0,0,0.45); font-weight:700;
      transition: width .18s ease, box-shadow .12s ease, background .12s;
      cursor:text; outline: none; align-self:flex-end; margin-top:6px;
    }
    .mini-input::placeholder { color: rgba(246,247,248,0.6); font-weight:600; }
    .mini-input:focus { width: 180px; background: rgba(255,255,255,0.045); box-shadow: 0 10px 24px rgba(0,0,0,0.55); }
    .mini-input:not(:placeholder-shown) { width: 180px; }

    .toast {
      position: fixed; bottom:24px; left:50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.8); color:#fff; padding:10px 14px; border-radius:8px;
      font-weight:700; opacity:0; pointer-events:none; transition: opacity .22s, transform .22s; z-index:9999;
    }
    .toast.show { opacity:1; transform: translateX(-50%) translateY(-6px); pointer-events:auto; }

    @media (max-width:880px) {
      .action-panel { width:100%; flex-direction:row; justify-content:space-between; align-items:center; }
      .action-buttons { flex-direction:row; gap:8px; }
      .message-preview-card { order:3; width:100%; }
      .action-panel { order:2; }
      .mini-input { align-self:center; margin-top:0; width:42px; }
      .mini-input:focus { width:140px; }
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true">
    <img id="bg-img" src="./fondo.jpg.jpg" alt="Fondo BET300VIP" />
    <div class="overlay"></div>
  </div>

  <div id="revinculacion-container">
    <div class="relinking-block">

      <div class="user-row">
        <input id="usuarioInputHidden" type="text" placeholder="Ingres치 nombre de usuario" aria-label="Nombre de usuario">
      </div>

      <div class="message-preview-card">
        <button class="msg-flip" id="msg-flip" title="Cambiar mensaje">游대</button>
        <p class="message-text">
          游녦 Hola <strong id="usuario-name">Amigo</strong><br>
          En <span class="brand">BET300VIP</span> nos renovamos 游눑<br>
          Ingres치 en 游녤 https://bet300.site/ con tu CLAVE 12345a y obten칠 un 30% DE BONO CON TU PRIMER CARGA 游꾸
        </p>
      </div>

      <div class="action-panel" role="group" aria-label="Panel de acciones">
        <div class="action-buttons" aria-label="Acciones del mensaje">
          <button class="glass-button copy-button" id="btn-copy" type="button" title="Copiar mensaje">游늶 Copiar mensaje</button>
          <button class="glass-button whatsapp-button" id="btn-wsp" type="button" title="Copiar enlace WhatsApp">游눫 Copiar WhatsApp</button>
        </div>

        <!-- INPUT MINIMAL (misma posici칩n de la lupa, justo debajo de los botones) -->
        <input id="usuarioInput" class="mini-input" type="text" placeholder="游댍" aria-label="Buscar usuario (Enter)" />
      </div>

    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    const mensajes = [
      "游녦 Hola {usuario}\nEn BET300VIP nos renovamos 游눑\nAhora todas las cargas se hacen desde 游녤 https://bet300.site/\nInici치 sesi칩n con tu misma CLAVE 12345a y realiz치 tu PRIMER CARGA para recibir un 30% DE BONO 游꾸",
      "游녦 Hola {usuario}\n춰Volvemos recargados en BET300VIP! 丘멮nA partir de ahora las cargas se realizan en 游녤 https://bet300.site/\nUs치 tu misma CLAVE 12345a y obten칠 un 30% DE BONO CON TU PRIMER CARGA 游눯",
      "游녦 Hola {usuario}\nBET300VIP cambi칩 para mejor 九\nIngres치 con tu misma CLAVE 12345a en 游녤 https://bet300.site/ y realiz치 tu PRIMER CARGA.\n游눶 Te espera un 30% DE BONO de regalo 游꾸"
    ];

    let variantIndex = 0;
    const usuarioNameEl = document.getElementById('usuario-name');
    const usuarioInput = document.getElementById('usuarioInput');
    const toastEl = document.getElementById('toast');

    function escapeHtml(str) {
      return String(str).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
    }

    function renderPreview() {
      const nombre = usuarioNameEl.textContent.trim() || 'Amigo';
      const texto = mensajes[variantIndex].replaceAll('{usuario}', nombre);
      const preview = document.querySelector('.message-text');
      preview.innerHTML = texto.split('\n').map(escapeHtml).join('<br>');
    }

    usuarioInput.addEventListener('input', () => {
      // mantener minimal: no actualizamos hasta confirmar b칰squeda,
      // pero reflejamos el posible nombre en vivo si desea:
      const v = usuarioInput.value.trim();
      usuarioNameEl.textContent = v || 'Amigo';
      renderPreview();
    });

    document.getElementById('msg-flip').addEventListener('click', (e) => {
      variantIndex = (variantIndex + 1) % mensajes.length;
      renderPreview();
      animateButton(e.currentTarget);
    });

    function copyTextToClipboard(text) {
      if (navigator.clipboard?.writeText) return navigator.clipboard.writeText(text);
      return new Promise((res,rej)=>{
        try {
          const ta=document.createElement('textarea');
          ta.value=text; ta.style.position='fixed'; ta.style.left='-9999px';
          document.body.appendChild(ta); ta.select(); document.execCommand('copy');
          document.body.removeChild(ta); res();
        } catch(e){ rej(e); }
      });
    }

    function showToast(msg) {
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      setTimeout(()=> toastEl.classList.remove('show'), 1600);
    }

    function animateButton(btn){
      if(!btn) return;
      btn.style.transform='scale(0.96)';
      setTimeout(()=>btn.style.transform='',140);
    }

    document.getElementById('btn-copy').addEventListener('click', (e) => {
      const nombre = usuarioNameEl.textContent.trim() || 'Amigo';
      const msg = mensajes[variantIndex].replaceAll('{usuario}', nombre);
      copyTextToClipboard(msg).then(()=>showToast('Mensaje copiado'));
      animateButton(e.currentTarget);
    });

    document.getElementById('btn-wsp').addEventListener('click', (e) => {
      const nombre = usuarioNameEl.textContent.trim() || 'Amigo';
      const msg = mensajes[variantIndex].replaceAll('{usuario}', nombre);
      const url = 'https://wa.me/?text=' + encodeURIComponent(msg);
      copyTextToClipboard(url).then(()=>showToast('Enlace WhatsApp copiado'));
      animateButton(e.currentTarget);
    });

    // BUSCADOR FUNCIONAL SIMULADO (usa el mini-input en la misma posici칩n)
    function mockSearchUser(name) {
      return new Promise((resolve) => {
        // simulaci칩n: nombres con 2+ caracteres se "encuentran"
        setTimeout(() => resolve(name.length >= 2), 520);
      });
    }

    async function searchUser() {
      const name = usuarioInput.value.trim();
      if (!name) { showToast('Ingres치 nombre de usuario'); usuarioInput.focus(); return; }

      // feedback visual: reducir opacidad del input moment치neamente
      usuarioInput.disabled = true;
      usuarioInput.style.opacity = '0.7';

      try {
        const found = await mockSearchUser(name);
        if (found) {
          usuarioNameEl.textContent = name;
          renderPreview();
          showToast('Usuario encontrado');
        } else {
          showToast('Usuario no encontrado');
        }
      } catch {
        showToast('Error en b칰squeda');
      } finally {
        usuarioInput.disabled = false;
        usuarioInput.style.opacity = '';
        usuarioInput.focus();
      }
    }

    // Enter en input dispara b칰squeda
    usuarioInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        searchUser();
      }
    });

    // click dentro del input (si est치 vac칤o) pone el caret y sugiere usar Enter
    usuarioInput.addEventListener('click', () => {
      if (!usuarioInput.value.trim()) usuarioInput.placeholder = '游댍 Ingres치 usuario y Enter';
    });
    usuarioInput.addEventListener('blur', () => {
      usuarioInput.placeholder = '游댍';
    });

    // Inicializar vista
    renderPreview();
  </script>
</body>
</html>
